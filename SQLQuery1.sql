CREATE DATABASE KontaktHome

CREATE TABLE Category
(
Id INT PRIMARY KEY IDENTITY,
Name VARCHAR(150) NOT NULL
)

CREATE TABLE Product
(
Id INT PRIMARY KEY IDENTITY,
Name VARCHAR(150) NOT NULL,
Price DECIMAL(18,2),
CategoryId INT FOREIGN KEY REFERENCES Category(Id)
)

CREATE TABLE Cart
(
Id INT PRIMARY KEY IDENTITY,
ProductId INT FOREIGN KEY REFERENCES Product(Id)
)


CREATE PROCEDURE USP_GET_CATEGORIES
AS
SELECT * FROM Category

EXEC USP_GET_CATEGORIES


CREATE PROCEDURE USP_GET_PRODUCTS
AS
SELECT * FROM Product

EXEC USP_GET_PRODUCTS


CREATE PROCEDURE USP_GET_CART
AS
SELECT * FROM Cart

EXEC USP_GET_CART



CREATE VIEW VW_Show_Categories
AS
SELECT * FROM Category

SELECT * FROM VW_Show_Categories


CREATE VIEW VW_Show_Products 
AS
SELECT * FROM Product

SELECT * FROM VW_Show_Products 


CREATE VIEW VW_Show_Cart
AS
SELECT * FROM Cart

SELECT * FROM VW_Show_Cart 



CREATE PROCEDURE USP_INSERT_INTO_CART @ProductId INT
AS
INSERT INTO Cart
VALUES
(@ProductId)


EXEC USP_INSERT_INTO_CART 3




CREATE PROCEDURE USP_DELETE_FROM_CART @ProductId INT
AS
DELETE FROM Cart
WHERE ProductId = @ProductId

EXEC USP_DELETE_FROM_CART 1



CREATE PROCEDURE USP_TOTAL_PRICE_IN_CART 
AS
SELECT SUM(P.Price) AS 'Total Price'
FROM Product AS P
JOIN Cart AS C
ON C.ProductId = P.Id


EXEC USP_TOTAL_PRICE_IN_CART 